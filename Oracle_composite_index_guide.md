
# 📘 Oracle 복합 인덱스(Composite Index) 튜닝 가이드

복합 인덱스는 둘 이상의 컬럼을 포함하는 인덱스로, 쿼리 성능 최적화에서 매우 중요한 역할을 합니다. 하지만 컬럼의 **순서**와 **사용 패턴**에 따라 인덱스 효과가 달라지므로 주의 깊게 설계해야 합니다.

---

## ✅ 1. 복합 인덱스란?

> 두 개 이상의 컬럼을 조합하여 만든 인덱스입니다.

```sql
CREATE INDEX IDX_EMP_DEPT_JOB ON EMP(DEPTNO, JOB);
```

---

## ✅ 2. 인덱스 컬럼의 순서가 중요한 이유

복합 인덱스는 **왼쪽부터 순차적으로 조건에 사용될 때**만 효율적으로 사용됩니다.

| WHERE 조건 예시 | 인덱스 사용 가능 여부 |
|------------------|------------------------|
| WHERE DEPTNO = 10 AND JOB = 'CLERK' | ✅ 전체 인덱스 사용 |
| WHERE DEPTNO = 10 | ✅ 부분 사용 (DEPTNO만) |
| WHERE JOB = 'CLERK' | ❌ 인덱스 사용 안됨 (DEPTNO가 빠짐) |

---

## ✅ 3. 컬럼 순서 선정 기준

### 🔹 (1) Selectivity (선별성)

- **중복이 적은 컬럼**일수록 앞에 배치하는 것이 좋음
- 인덱스의 필터링 능력이 높아져 성능 향상

### 🔹 (2) WHERE 절에서의 사용 빈도

- 자주 사용되는 컬럼을 앞에 배치
- 특히 단독으로 WHERE 조건에 자주 등장하면 우선 배치 고려

### 🔹 (3) 정렬 조건과의 일치

- ORDER BY 컬럼 순서와 인덱스 순서를 맞추면 정렬 비용을 줄일 수 있음

### 🔹 (4) 조인 조건

- 자주 조인에 사용되는 컬럼은 앞쪽에 배치하면 좋음

---

## ✅ 4. 실전 예시

### 예제 1: WHERE 조건 우선

```sql
-- 선별성이 높은 EMP_NO를 앞에 배치
CREATE INDEX IDX_DEPT_EMP ON EMP(EMP_NO, DEPTNO);
```

### 예제 2: ORDER BY 최적화

```sql
-- ORDER BY DEPTNO, HIRE_DATE 를 고려한 인덱스
CREATE INDEX IDX_ORDER_OPT ON EMP(DEPTNO, HIRE_DATE);
```

---

## ✅ 5. 유의사항

- 복합 인덱스는 **왼쪽부터 순차적 조건**이 맞지 않으면 무용지물
- 너무 많은 컬럼을 포함하면 인덱스 크기 증가 및 유지 비용 상승
- SELECT 절만으로는 인덱스 효율이 나지 않음 (WHERE나 JOIN 기준이 중요)

---

## 📌 마무리 요약

- 복합 인덱스는 성능 향상에 강력하지만, **순서가 핵심**
- **중복 적고 자주 사용되는 컬럼**을 앞에 두어 설계
- 항상 실행 계획을 통해 실제 효과를 검증할 것

> 🔧 "복합 인덱스는 설계 순서가 생명이다"
