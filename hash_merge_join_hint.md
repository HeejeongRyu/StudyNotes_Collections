
# 📘 Oracle 조인 방식 정리: HASH JOIN & MERGE JOIN

Oracle에서는 두 개 이상의 테이블을 조인할 때 다양한 전략을 사용합니다.  
그 중에서도 **Hash Join**과 **Merge Join**은 대용량 데이터 처리에 자주 사용되는 효율적인 조인 방식입니다.

---

## 🔹 1. Hash Join

### ✅ 개념

Hash Join은 **조인 키 값을 기준으로 해시 테이블을 생성**하여 데이터를 조인하는 방식입니다.

- 먼저 **작은 테이블**(Build input)에 대해 **해시 테이블**을 만듦
- 큰 테이블(Probe input)의 각 행에 대해 해시 테이블을 조회해 조인

---

### ✅ 사용 시기

| 조건 | 설명 |
|------|------|
| 대용량 테이블 조인 | Index 없이도 빠름 |
| 인덱스 미존재 또는 비효율적일 때 | Full Scan 기반의 고속 조인 |
| 정렬 조건 없음 | 정렬보다 해시 탐색이 빠름 |

---

### ✅ 예시

```sql
SELECT /*+ USE_HASH(E D) */ *
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;
```

---

### ❌ 단점

- 해시 테이블이 메모리를 초과하면 **TEMP I/O 발생** → 성능 저하
- 조인 대상이 작을 경우 불필요하게 무거울 수 있음

---

## 🔹 2. Merge Join

### ✅ 개념

Merge Join은 **양쪽 테이블을 정렬한 뒤 병합**하는 방식입니다.  
정렬된 상태에서 양쪽 커서를 동시에 이동하며 값을 비교 → 성능이 뛰어남

---

### ✅ 사용 시기

| 조건 | 설명 |
|------|------|
| 양쪽 테이블 모두 **정렬되어 있거나 정렬 가능**할 때 | 정렬 병합 방식이 유리 |
| 인덱스를 사용한 정렬 가능 | 성능 극대화 가능 |
| **대용량 INNER JOIN**일 때 | 빠르고 안정적 |

---

### ✅ 예시

```sql
SELECT /*+ USE_MERGE(E D) */ *
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;
```

---

### ❌ 단점

- 양쪽 정렬이 필요 → 정렬 비용 발생
- **비정렬된 데이터** 조인 시 느려질 수 있음

---

## ✅ 조인 방식 비교 요약

| 방식 | 장점 | 단점 | 추천 상황 |
|------|------|------|-----------|
| Nested Loop | 인덱스 활용 시 빠름 | 반복 많으면 느림 | 소량 데이터, 인덱스 존재 |
| Hash Join | 정렬 불필요, 대용량에 강함 | 메모리 부족 시 느림 | 대용량, 인덱스 없음 |
| Merge Join | 정렬된 테이블 조인 시 빠름 | 정렬 필요 | 양쪽 정렬 가능 시 |

---

## 🧾 마무리 팁

- 옵티마이저는 데이터 양과 통계에 따라 자동으로 조인 방식을 선택
- 힌트(`USE_HASH`, `USE_NL`, `USE_MERGE`)로 강제 가능
- 조인 순서는 `LEADING`으로 제어 가능

> 💡 대량 조인에서는 Hash Join이 가장 일반적으로 선택되며,  
> 정렬된 결과가 필요한 경우 Merge Join이 유리할 수 있습니다.
